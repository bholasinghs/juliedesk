'use strict';if(typeof module!=='undefined'&&module!==null&&eval('typeof require')!=='undefined'&&eval('require')!==null&&'main'in eval('require')&&eval('typeof require.main')!=='undefined'&&eval('require.main')!==null){var ORIGINAL_MAIN_MODULE=module;if(module!==eval('require.main')&&'paths'in module&&'paths'in eval('require.main')&&typeof __dirname!=='undefined'&&__dirname!==null)module.paths=eval('require.main.paths').concat(module.paths.filter(function(path){return eval('require.main.paths').includes(path)}))};if(typeof window==='undefined'||window===null)var window=(typeof global==='undefined'||global===null)?{}:global;!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("clientnode"),require("@babel/runtime/helpers/defineProperty"),require("@babel/runtime/helpers/assertThisInitialized"),require("@babel/runtime/regenerator"),require("@babel/runtime/helpers/asyncToGenerator"),require("@babel/runtime/helpers/inheritsLoose")):"function"==typeof define&&define.amd?define("internationalisation",["clientnode","@babel/runtime/helpers/defineProperty","@babel/runtime/helpers/assertThisInitialized","@babel/runtime/regenerator","@babel/runtime/helpers/asyncToGenerator","@babel/runtime/helpers/inheritsLoose"],t):"object"==typeof exports?exports.internationalisation=t(require("clientnode"),require("@babel/runtime/helpers/defineProperty"),require("@babel/runtime/helpers/assertThisInitialized"),require("@babel/runtime/regenerator"),require("@babel/runtime/helpers/asyncToGenerator"),require("@babel/runtime/helpers/inheritsLoose")):e.internationalisation=t(e.clientnode,e["@babel/runtime/helpers/defineProperty"],e["@babel/runtime/helpers/assertThisInitialized"],e["@babel/runtime/regenerator"],e["@babel/runtime/helpers/asyncToGenerator"],e["@babel/runtime/helpers/inheritsLoose"])}(window,(function(e,t,n,o,r,i){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=6)}([function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t){e.exports=n},function(e,t){e.exports=o},function(e,t){e.exports=r},function(e,t){e.exports=i},function(e,t,n){e.exports=n(7)},function(e,t,n){"use strict";n.r(t),n.d(t,"Internationalisation",(function(){return _}));var o=n(3),r=n.n(o),i=n(4),a=n.n(i),s=n(2),l=n.n(s),u=n(5),c=n.n(u),p=n(1),d=n.n(p),h=n(0),g=n.n(h);function m(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0;return function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=Array(t);n<t;n++)o[n]=e[n];return o}var _=function(e){function t(){for(var n,o=arguments.length,r=Array(o),i=0;i<o;i++)r[i]=arguments[i];return n=e.call.apply(e,[this].concat(r))||this,d()(l()(n),"$domNodes",null),d()(l()(n),"currentLanguage","enUS"),d()(l()(n),"knownTranslations",{}),d()(l()(n),"self",t),d()(l()(n),"_$domNodeToFade",null),d()(l()(n),"_options",{currentLanguageIndicatorClassName:"current",currentLanguagePattern:"^[a-z]{2}[A-Z]{2}$",default:"enUS",domNodes:{knownTranslation:"div.toc"},fadeEffect:!0,initial:null,languageHashPrefix:"language-",languageMapping:{deDE:["de","de_de","de-de","german","deutsch"],enUS:["en","en_us","en-us"],enEN:["en_en","en-en","english"],frFR:["fr","fr_fr","fr-fr","french"]},onSwitched:g.a.noop,onEnsured:g.a.noop,onSwitch:g.a.noop,onEnsure:g.a.noop,preReplacementLanguagePattern:"^\\|({1})$",replaceDomNodeNames:["#text","langreplace"],replacementDomNodeName:["#comment","langreplacement"],replacementLanguagePattern:"^([a-z]{2}[A-Z]{2}):((.|\\s)*)$",selection:[],sessionDescription:"{1}",templateDelimiter:{pre:"{{",post:"}}"},textNodeParent:{hideAnimation:[{opacity:0},{duration:"fast"}],showAnimation:[{opacity:1},{duration:"fast"}]},toolsLockDescription:"{1}Switch"}),d()(l()(n),"_replacements",[]),d()(l()(n),"_textNodesWithKnownTranslation",{}),n}c()(t,e);var n=t.prototype;return n.initialize=function(t){var n=this;void 0===t&&(t={}),e.prototype.initialize.call(this,t),this._options.preReplacementLanguagePattern=g.a.stringFormat(this._options.preReplacementLanguagePattern,this._options.replacementLanguagePattern.substr(1,this._options.replacementLanguagePattern.length-2)),this._options.toolsLockDescription=g.a.stringFormat(this._options.toolsLockDescription,this.self._name),this._options.sessionDescription=g.a.stringFormat(this._options.sessionDescription,this.self._name),this.$domNodes=this.grabDomNode(this._options.domNodes,this.$domNode),this.$domNodes.switchLanguageButtons=Object(h.$)('a[href^="#'+this._options.languageHashPrefix+'"]'),this._movePreReplacementNodes(),this.currentLanguage=this._normalizeLanguage(this._options.default);var o=this._determineUsefulLanguage();return this.on(this.$domNodes.switchLanguageButtons,"click",(function(e){return e.preventDefault(),n.switch(Object(h.$)(e.target).attr("href").substr(n._options.languageHashPrefix.length+1))})),this.currentLanguage===o?(this._switchCurrentLanguageIndicator(o),Promise.resolve(this.$domNode)):this.switch(o,!0)},n.switch=function(){var e=a()(r.a.mark((function e(t,n){var o,i,a,s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===n&&(n=!1),!0===t||!this._options.selection.length||this._options.selection.includes(t)){e.next=4;break}return this.debug('"{1}" isn\'t one of the allowed languages.',t),e.abrupt("return",this.$domNode);case 4:return e.next=6,this.acquireLock(this._options.toolsLockDescription);case 6:if(!0===t?(n=!0,t=this.currentLanguage):t=this._normalizeLanguage(t),!(n&&t!==this._options.default||this.currentLanguage!==t)){e.next=21;break}return o="Switch to",n&&(o="Ensure"),this.debug('{1} "{2}".',o,t),this._switchCurrentLanguageIndicator(t),e.next=14,this.fireEvent(n?"ensure":"switch",!0,this,this.currentLanguage,t);case 14:return this._$domNodeToFade=null,this._replacements=[],i=this._collectTextNodesToReplace(t,n),a=i[0],s=i[1],this._ensureLastTextNodeHavingLanguageIndicator(a,s,n),e.next=20,this._handleSwitchEffect(t,n);case 20:return e.abrupt("return",this.$domNode);case 21:return this.debug('"{1}" is already current selected language.',t),this.releaseLock(this._options.toolsLockDescription),e.abrupt("return",this.$domNode);case 24:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.refresh=function(){return this._movePreReplacementNodes(),this.switch(!0)},n._handleSwitchEffect=function(){var e=a()(r.a.mark((function e(t,n){var o,i,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=this.currentLanguage,n||!this._options.fadeEffect||!this._$domNodeToFade){e.next=12;break}return e.next=4,(i=this._$domNodeToFade).animate.apply(i,this._options.textNodeParent.hideAnimation).promise();case 4:if(this._switchLanguage(t),!this._$domNodeToFade){e.next=11;break}return e.next=8,(a=this._$domNodeToFade).animate.apply(a,this._options.textNodeParent.showAnimation).promise();case 8:return e.next=10,this.fireEvent(n?"ensured":"switched",!0,this,o,t);case 10:this.releaseLock(this._options.toolsLockDescription);case 11:return e.abrupt("return");case 12:return this._switchLanguage(t),e.next=15,this.fireEvent(n?"ensured":"switched",!0,this,o,t);case 15:this.releaseLock(this._options.toolsLockDescription);case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n._movePreReplacementNodes=function(){var e=this;this.$domNode.find(":not(iframe)").contents().each((function(){var t=Object(h.$)(this),n=t.prop("nodeName").toLowerCase();if(e._options.replacementDomNodeName.includes(n)){["#comment","#text"].includes(n)||t.hide();var o=new RegExp(e._options.preReplacementLanguagePattern),r=t.prop("textContent").match(o);if(r&&r[0]){t.prop("textContent",t.prop("textContent").replace(o,r[1]));var i=!1;t.parent().contents().each((function(){return i&&Object(h.$)(this).Tools("text").trim()?(t.appendTo(this),!1):void(t[0]===this&&(i=!0))}))}}}))},n._collectTextNodesToReplace=function(e,t){var n=null,o=null,r=null,i=null;this.knownTranslations={};var a=this;return this.$domNode.find(":not(iframe)").contents().each((function(){var s=Object(h.$)(this),l=s.prop("nodeName").toLowerCase();if(a._options.replaceDomNodeNames.includes(l.toLowerCase()))s.Tools("text").trim()&&0===s.parents(a._options.replaceDomNodeNames.join()).length&&(i=a._ensureLastTextNodeHavingLanguageIndicator(r,i,t),n=s);else if(n){if(a._options.replacementDomNodeName.includes(l)){var u=s.prop("textContent");"#comment"!==l&&(u=s.html());var c=u.match(new RegExp(a._options.replacementLanguagePattern));return void(Array.isArray(c)&&c[1]===e?(a.knownTranslations[n.Tools("text").trim()]=c[2].trim(),a._registerTextNodeToChange(n,s,c,o),r=n,i=o,n=null,o=null):s.prop("textContent").match(new RegExp(a._options.currentLanguagePattern))&&(o=s))}r=null,i=null,n=null,o=null}})),this._registerKnownTextNodes(),[r,i]},n._registerKnownTextNodes=function(){this._textNodesWithKnownTranslation={};var e=this;this.$domNodes.knownTranslation.find(":not(iframe)").contents().each((function(){var t=Object(h.$)(this);!e._options.replaceDomNodeNames.includes(t.prop("nodeName").toLowerCase())&&t.Tools("text").trim()&&0===t.parents(e._options.replaceDomNodeNames.join()).length&&e.knownTranslations.hasOwnProperty(t.Tools("text").trim())&&(e._addTextNodeToFade(t),e._textNodesWithKnownTranslation[e.knownTranslations[t.prop("textContent").trim()]]=e._textNodesWithKnownTranslation.hasOwnProperty(e.knownTranslations[t.prop("textContent").trim()])?e._textNodesWithKnownTranslation[e.knownTranslations[t.prop("textContent").trim()]].add(this):t)}))},n._normalizeLanguage=function(e){for(var t in this._options.languageMapping)if(this._options.languageMapping.hasOwnProperty(t)&&(this._options.languageMapping[t].includes(t.toLowerCase())||this._options.languageMapping[t].push(t.toLowerCase()),this._options.languageMapping[t].includes(e.toLowerCase())))return t;return this._options.default},n._determineUsefulLanguage=function(){var e,t;if(this._options.initial)t=this._options.initial;else if(h.$.global.window){var n,o;(null==(n=h.$.global.window.localStorage)||null==n?void 0:n.getItem(this._options.sessionDescription))?(t=h.$.global.window.localStorage.getItem(this._options.sessionDescription),this.debug('Determine "'+t+'", because of local storage information.')):(null==(o=h.$.global.window.navigator)||null==o?void 0:o.language)&&(t=h.$.global.window.navigator.language,this.debug('Determine "'+t+'", because of browser settings.'))}return t||(t=this._options.default,this.debug('Determine "'+t+'", because of default option.')),t=this._normalizeLanguage(t),this._options.selection.length&&!this._options.selection.includes(t)&&(this.debug('"'+t+'" isn\'t one of the allowed languages. Set language to "'+this._options.selection[0]+'".'),t=this._options.selection[0]),(null==(e=h.$.global.window)||null==e?void 0:e.localStorage)&&h.$.global.window.localStorage.setItem(this._options.sessionDescription,t),t},n._addTextNodeToFade=function(e){var t=e.parent();this._$domNodeToFade=this._$domNodeToFade?this._$domNodeToFade.add(t):t},n._registerTextNodeToChange=function(e,t,n,o){this._addTextNodeToFade(e),t&&this._replacements.push({$textNodeToTranslate:e,$nodeToReplace:t,textToReplace:n[2],$currentLanguageDomNode:o})},n._ensureLastTextNodeHavingLanguageIndicator=function(e,t,n){if(e&&!t){var o=this.currentLanguage;n&&(o=this._options.default),t=Object(h.$)("\x3c!--"+o+"--\x3e"),e.after(t)}return t},n._switchLanguage=function(e){for(var t,n=this,o=function(){var o=t.value,r=o.$textNodeToTranslate.html();"#text"===o.$textNodeToTranslate.prop("nodeName")&&(r=o.$textNodeToTranslate.prop("textContent"));var i=r.trim();if(!n._options.templateDelimiter||!i.endsWith(n._options.templateDelimiter.post)&&n._options.templateDelimiter.post){var a=o.$currentLanguageDomNode;if(!a){a=Object(h.$)("body");var s=!1;o.$textNodeToTranslate.parent().contents().each((function(){return s?(o.$currentLanguageDomNode=a=Object(h.$)(this),!1):void(this===o.$textNodeToTranslate[0]&&(s=!0))}))}var l=a.prop("textContent");e===l&&n.warn('Text node "'+o.textToReplace+'" is marked as "'+l+'" and has same translation language as it already is.');var u=o.$nodeToReplace.prop("nodeName").toLowerCase();"#comment"===u?o.$textNodeToTranslate.after(Object(h.$)("\x3c!--"+l+":"+r+"--\x3e")):o.$textNodeToTranslate.after(Object(h.$)("<"+u+">"+l+":"+r+"</"+u+">").hide()),o.$textNodeToTranslate.after(Object(h.$)("\x3c!--"+e+"--\x3e")),"#text"===o.$textNodeToTranslate.prop("nodeName")?o.$textNodeToTranslate.prop("textContent",o.textToReplace):o.$textNodeToTranslate.html(o.textToReplace),a.remove(),o.$nodeToReplace.remove()}},r=m(this._replacements);!(t=r()).done;)o();for(var i in this._textNodesWithKnownTranslation)this._textNodesWithKnownTranslation.hasOwnProperty(i)&&this._textNodesWithKnownTranslation[i].prop("textContent",i);"localStorage"in h.$.global&&h.$.global.localStorage.setItem(this._options.sessionDescription,e),this.currentLanguage=e},n._switchCurrentLanguageIndicator=function(e){Object(h.$)('a[href="#'+this._options.languageHashPrefix+this.currentLanguage+'"].'+this._options.currentLanguageIndicatorClassName).removeClass(this._options.currentLanguageIndicatorClassName),Object(h.$)('a[href="#'+this._options.languageHashPrefix+e+'"]').addClass(this._options.currentLanguageIndicatorClassName)},t}(h.BoundTools);d()(_,"_name","Internationalisation"),t.default=_,h.$.fn&&(h.$.fn.Internationalisation=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return h.$.Tools().controller(_,t,this)})}])}));